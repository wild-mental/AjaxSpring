<html lang="kr">
<head>
    <title>북마크 관리</title>
    <meta charset="utf-8">
</head>
<body>
<h1>북마크 관리 페이지</h1>
<h2>북마크 저장</h2>
<form onsubmit="return addBookmarkRequest();">
    <label for="name">북마크 이름 : </label><input type="text" name="name" id="name"><br>
    <label for="url">북마크 URL : </label><input type="text" name="url" id="url"><br>
    <input type="submit" value="북마크 저장"><br>
</form>
<h2>북마크 조회</h2>
<button onclick="getBookmarkListRequest();">북마크 목록 조회</button>
<ol id="bookmark-list">
    <!-- 여기에 북마크 목록 출력 -->
</ol>

<script>
    function addBookmarkRequest() {
        const name = document.querySelector('input[name=name]').value;
        const url = document.querySelector('input[name=url]').value;
        const requestObject = {name: name, url: url};

        fetch('/bookmark', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json'
            },
            body: JSON.stringify(requestObject)
        }).then(response => {
            if (response.ok) {
                return response.text();
            } else {
                throw new Error('Network response was not ok.');
            }
        }).then(() => {
            alert("북마크 저장 완료.");
        }).catch(error => {
            console.error('Request failed', error);
        });

        return false;
    }

    function getBookmarkListRequest() {
        fetch('/bookmarks')
            .then(response => {
                if (response.ok) {
                    return response.json();
                } else {
                    throw new Error('Network response was not ok.');
                }
            }).then(bookmarks => {
            const bookmarkListDom = document.querySelector('#bookmark-list');
            bookmarkListDom.innerHTML = '';
            bookmarks.forEach(bookmark => {
                const liNode = document.createElement('li');
                const textNode = document.createTextNode(bookmark.name + ' - ' + bookmark.url);
                liNode.appendChild(textNode);
                bookmarkListDom.appendChild(liNode);
            });
        }).catch(error => {
            console.error('Request failed', error);
        });
    }
</script>
</body>
</html>
